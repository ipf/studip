jQuery(function(a){a(".bookable_rooms_action").bind("click",function(d){var b=a(this).prev("select")[0];var c=a(this);if(b!==null&&b!==undefined){if(c.attr("data-state")==="enabled"){STUDIP.Raumzeit.disableBookableRooms(c)}else{c.attr("src",STUDIP.ASSETS_URL+"images/ajax_indicator_small.gif");if(c.data("options")===undefined){c.data("options",a(b).children("option").clone(true))}else{a(b).empty().append(c.data("options").clone(true))}a.ajax({type:"POST",url:STUDIP.ABSOLUTE_URI_STUDIP+"dispatch.php/resources/helpers/bookable_rooms",data:{rooms:_.pluck(b.options,"value"),selected_dates:_.pluck(a('input[name="singledate[]"]:checked'),"value"),singleDateID:a("input[name=singleDateID]").attr("value"),new_date:_.map(a("#startDate,#start_stunde,#start_minute,#end_stunde,#end_minute"),function(e){return{name:e.id,value:e.value}})},success:function(e){if(a.isArray(e)){if(e.length){var f=_.map(e,function(g){return a(b).children("option[value="+g+"]").text().trim()});b.title="Nicht buchbare R채ume:".toLocaleString()+" "+f.join(", ")}else{b.title=""}_.each(e,function(g){a(b).children("option[value="+g+"]").attr("disabled","disabled")})}else{b.title=""}c.attr("src",STUDIP.ASSETS_URL+"images/icons/16/blue/room-clear.png");c.attr("title","Alle R채ume anzeigen".toLocaleString());c.attr("data-state","enabled")}})}}});a(".bookable_rooms_action").show();a("input[type=checkbox]").bind("change",function(){STUDIP.Raumzeit.disableBookableRooms(a("img[data-name=bulk_action]"))})});jQuery(function(a){STUDIP.BlockAppointmentsDialog={dialog:null,reloadUrlOnClose:null,initialize:function(b){if(STUDIP.BlockAppointmentsDialog.dialog===null){a.ajax({url:b,data:{},success:function(c){STUDIP.BlockAppointmentsDialog.dialog=jQuery('<div id="BlockAppointmentsDialogbox">'+c.content+"</div>").dialog({show:"",hide:"scale",title:c.title,draggable:true,modal:true,resizable:false,width:Math.min(800,a(window).width()-64),height:"auto",maxHeight:a(window).height(),close:function(){a(this).remove();STUDIP.BlockAppointmentsDialog.dialog=null}});STUDIP.BlockAppointmentsDialog.bindevents()}})}},bindevents:function(){a("form[name$=block_appointments] button[type=submit]").bind("click dblclick",function(){var b=this.name;var c=a("form[name$=block_appointments]")[0];STUDIP.BlockAppointmentsDialog.submit(c,b);return false});a("form[name$=block_appointments] .hasDatePicker").datepicker();a("form[name$=block_appointments] .hasDatePicker").blur();a("#block_appointments_days input:checkbox").click(function(){var b=parseInt(this.id.split("_").pop(),10);if(b===0||b===1){a("#block_appointments_days input:checkbox").attr("checked",function(c){return c===b})}else{a("#block_appointments_days_0").attr("checked",false);a("#block_appointments_days_1").attr("checked",false)}})},submit:function(c,b){if(c){var d=a(c).serializeArray();d.push({name:b,value:1});STUDIP.BlockAppointmentsDialog.update(c.action,d)}},update:function(b,c){var d=a("#BlockAppointmentsDialogbox").parent().zIndex();a("#BlockAppointmentsDialogbox").parent().zIndex(d-1);a.ajax({type:"POST",url:b,data:c,success:function(e){if(STUDIP.BlockAppointmentsDialog.dialog!==null){if(e.auto_close===true){STUDIP.BlockAppointmentsDialog.dialog.dialog("close");if(e.auto_reload===true&&STUDIP.BlockAppointmentsDialog.reloadUrlOnClose!==null){document.location.replace(STUDIP.BlockAppointmentsDialog.reloadUrlOnClose)}}else{STUDIP.BlockAppointmentsDialog.dialog.dialog("option","title",e.title);a("#BlockAppointmentsDialogbox").html(e.content);a("#BlockAppointmentsDialogbox").parent().zIndex(d);STUDIP.BlockAppointmentsDialog.bindevents()}}}})}}});STUDIP.Raumzeit={toggleCheckboxes:function(b){var a=false;jQuery("table[data-cycleid="+b+"] input[name^=singledate]").each(function(){if(jQuery(this).attr("checked")){a=true}});jQuery("table[data-cycleid="+b+"] input[name*=singledate]").attr("checked",!a)},addLecturer:function(){jQuery("select[name=teachers] option:selected").each(function(){var a=jQuery(this).val();if(a==="none"){return}jQuery("li[data-lecturerid="+a+"]").show();jQuery("select[name=teachers] option[value="+a+"]").hide();jQuery("select[name=teachers] option[value=none]").attr("selected","selected")});STUDIP.Raumzeit.addFormLecturers()},removeLecturer:function(a){if(jQuery("ul.teachers li:visible").size()>1){jQuery("li[data-lecturerid="+a+"]").hide();jQuery("select[name=teachers] option[value="+a+"]").show()}else{if(jQuery("div.at_least_one_teacher").size()===0){jQuery("ul.teachers").before('<div class="at_least_one_teacher" style="display: none"><i>'+"Jeder Termin muss mindestens eine Person haben, die ihn durchf체hrt!".toLocaleString()+"</i><div>");jQuery("div.at_least_one_teacher").slideDown().delay(3000).fadeOut(400,function(){jQuery(this).remove()});jQuery("li[data-lecturerid="+a+"]").effect("shake",100)}}STUDIP.Raumzeit.addFormLecturers()},addFormLecturers:function(){var a=[];jQuery("ul.teachers li:visible").each(function(){a.push(jQuery(this).attr("data-lecturerid"))});jQuery("input[name=related_teachers]").val(a.join(","))},disableBookableRooms:function(b){var a=$(b).prev("select")[0];var c=$(b);$(a).children("option").each(function(){$(this).attr("disabled",false)});c.attr("data-state",false);c.attr("src",STUDIP.ASSETS_URL+"images/icons/16/grey/room-clear.png");c.attr("title","Nur buchbare R채ume anzeigen".toLocaleString())}};jQuery(function(a){STUDIP.CancelDatesDialog={dialog:null,reloadUrlOnClose:null,initialize:function(b){if(STUDIP.CancelDatesDialog.dialog===null){a.ajax({url:b,data:{},success:function(c){STUDIP.CancelDatesDialog.dialog=jQuery('<div id="CancelDatesDialogbox">'+c.content+"</div>").dialog({show:"",hide:"scale",title:c.title,draggable:true,modal:true,resizable:false,width:Math.min(800,a(window).width()-64),height:"auto",maxHeight:a(window).height(),close:function(){a(this).remove();STUDIP.CancelDatesDialog.dialog=null}});STUDIP.CancelDatesDialog.bindevents()}})}},bindevents:function(){a("form[name$=cancel_dates] button[type=submit]").bind("click dblclick",function(){var b=this.name;var c=a("form[name$=cancel_dates]")[0];STUDIP.CancelDatesDialog.submit(c,b);return false})},submit:function(c,b){if(c){var d=a(c).serializeArray();d.push({name:b,value:1});STUDIP.CancelDatesDialog.update(c.action,d)}},update:function(b,c){var d=a("#CancelDatesDialogbox").parent().zIndex();a("#CancelDatesDialogbox").parent().zIndex(d-1);a.ajax({type:"POST",url:b,data:c,success:function(e){if(STUDIP.CancelDatesDialog.dialog!==null){if(e.auto_close===true){STUDIP.CancelDatesDialog.dialog.dialog("close");if(e.auto_reload===true&&STUDIP.CancelDatesDialog.reloadUrlOnClose!==null){document.location.replace(STUDIP.CancelDatesDialog.reloadUrlOnClose)}}else{STUDIP.CancelDatesDialog.dialog.dialog("option","title",e.title);a("#CancelDatesDialogbox").html(e.content);a("#CancelDatesDialogbox").parent().zIndex(d);STUDIP.CancelDatesDialog.bindevents()}}}})}}});